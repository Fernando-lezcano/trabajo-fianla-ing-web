<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RockStore - P치gina</title>

    <!-- Bootstrap CSS -->
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
        rel="stylesheet">

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tu CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>

    <!-- METANAVEGACI칍N -->
    <div class="top-meta">
        <a href="#">Iniciar sesi칩n</a>
        <a href="#">Registrarse</a>
        <input type="text" placeholder="Buscar...">
    </div>

    <!-- NAVBAR PRINCIPAL -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
    <a class="navbar-brand" href="index.html">游꿪 RockStore</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#menu">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="menu">
        <ul class="navbar-nav ms-3">
            <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
            <!-- Dropdown con hover -->
            <li class="nav-item dropdown hover-dropdown">
                <a class="nav-link dropdown-toggle" href="store.html" id="storeMenu" role="button">
                    Tienda
                </a>
                <ul class="dropdown-menu" aria-labelledby="storeMenu">
                    <li><a class="dropdown-item" href="instrumentos.html">Instrumentos</a></li>
                    <li><a class="dropdown-item" href="ropaMujer.html">Ropa Mujer</a></li>
                    <li><a class="dropdown-item" href="ropaHombre.html">Ropa Hombre</a></li>
                </ul>
            </li>
            <li class="nav-item"><a class="nav-link" href="offers.html">Offers</a></li>
        </ul>
        <!-- Enlaces Cart y Account alineados a la derecha -->
        <ul class="navbar-nav ms-auto">
            <li class="nav-item">
                <a class="nav-link" href="cart.html">
                    <i class="fas fa-shopping-cart"></i> Carrito
                </a>
            </li>
            <li class="nav-item">
                    <a class="nav-link" href="cuenta.html">
                    <i class="fas fa-user"></i> Cuenta
                </a>
            </li>
        </ul>
    </div>
</nav>


    <!-- Header -->
    <div class="admin-header">
        
    </div>

    <!-- Main Container -->
    <div class="main-container">

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="showTab('productos')">Productos</button>
            <button class="tab-btn" onclick="showTab('reportes')">Reportes</button>
        </div>

        <!-- Productos Section -->
        <div id="productosSection">

        <!-- Section Header -->
        <div class="section-header">
            <h2 class="section-title">Registrar productos</h2>
            <button class="new-product-btn" onclick="openModal('new')">
                <i class="fas fa-plus"></i> Nuevo Producto
            </button>
        </div>

        <!-- Products Table -->
        <div class="products-table-container">
            <h3 class="table-title">Lista de productos</h3>

            <table class="products-table" id="productsTable">
                <thead>
                    <tr>
                        <th>C칩digo</th>
                        <th>Producto</th>
                        <th>Categor칤a</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td>PROD001</td>
                        <td>Tenor</td>
                        <td>Percusi칩n</td>
                        <td>$600.00</td>
                        <td>4</td>
                        <td><span class="stock-badge stock-low">Stock bajo</span></td>
                        <td>
                            <button class="action-btn" onclick="openModal('edit', 0)">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteProduct(0)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>PROD002</td>
                        <td>Bater칤a</td>
                        <td>Percusi칩n</td>
                        <td>$1000.00</td>
                        <td>23</td>
                        <td><span class="stock-badge stock-ok">En Stock</span></td>
                        <td>
                            <button class="action-btn" onclick="openModal('edit', 1)">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteProduct(1)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Update Button -->
        <button class="update-btn" onclick="updateInventory()">
            <i class="fas fa-sync-alt"></i> Actualizar
        </button>

        <!-- Edit Icon (bottom right) -->
        <div class="edit-icon" title="Editar configuraci칩n">
            <i class="fas fa-edit"></i>
        </div>
        </div><!-- End Productos Section -->

        <!-- Reportes Section -->
        <div id="reportesSection" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Reportes e Inventario</h2>
                <button class="new-product-btn" onclick="generateReport()">
                    <i class="fas fa-file-download"></i> Exportar PDF
                </button>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #dc3545 0%, #a91220 100%);">
                        <i class="fas fa-box"></i>
                    </div>
                    <div class="stat-info">
                        <h4 id="totalProducts">0</h4>
                        <p>Total Productos</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h4 id="totalValue">$0.00</h4>
                        <p>Valor Inventario</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h4 id="lowStock">0</h4>
                        <p>Stock Bajo</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);">
                        <i class="fas fa-tags"></i>
                    </div>
                    <div class="stat-info">
                        <h4 id="categories">0</h4>
                        <p>Categor칤as</p>
                    </div>
                </div>
            </div>

            <!-- Charts Row -->
            <div class="charts-row">
                <div class="chart-container">
                    <h5>Productos por Categor칤a</h5>
                    <canvas id="categoryChart"></canvas>
                </div>

                <div class="chart-container">
                    <h5>Estado del Stock</h5>
                    <canvas id="stockChart"></canvas>
                </div>
            </div>

            <!-- Table de resumen -->
            <div class="products-table-container mt-4">
                <h3 class="table-title">Resumen por Categor칤a</h3>
                <table class="products-table">
                    <thead>
                        <tr>
                            <th>Categor칤a</th>
                            <th>Cantidad</th>
                            <th>Stock Total</th>
                            <th>Valor Total</th>
                            <th>Promedio Precio</th>
                        </tr>
                    </thead>
                    <tbody id="summaryTableBody">
                        <!-- Llenado din치micamente -->
                    </tbody>
                </table>
            </div>
        </div><!-- End Reportes Section -->

    </div>

    <!-- Modal for New/Edit Product -->
    <div class="modal-overlay" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Nuevo Producto</h3>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>

            <form id="productForm">
                <div class="form-group">
                    <label>C칩digo</label>
                    <input type="text" id="codigo" placeholder="PROD003" required>
                </div>

                <div class="form-group">
                    <label>Nombre del Producto</label>
                    <input type="text" id="producto" placeholder="Ej: Guitarra el칠ctrica" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Categor칤a</label>
                        <select id="categoria" required>
                            <option value="">Seleccionar...</option>
                            <option value="Percusi칩n">Percusi칩n</option>
                            <option value="Cuerdas">Cuerdas</option>
                            <option value="Vientos">Vientos</option>
                            <option value="Electr칩nica">Electr칩nica</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Precio</label>
                        <input type="number" id="precio" placeholder="0.00" step="0.01" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Stock</label>
                        <input type="number" id="stock" placeholder="0" required>
                    </div>

                    <div class="form-group">
                        <label>Estado</label>
                        <select id="estado" required>
                            <option value="En Stock">En Stock</option>
                            <option value="Stock bajo">Stock bajo</option>
                            <option value="Agotado">Agotado</option>
                        </select>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeModal()">Cancelar</button>
                    <button type="submit" class="btn-save">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        let products = [
            {
                codigo: 'PROD001',
                producto: 'Tenor',
                categoria: 'Percusi칩n',
                precio: 600.00,
                stock: 4,
                estado: 'Stock bajo'
            },
            {
                codigo: 'PROD002',
                producto: 'Bater칤a',
                categoria: 'Percusi칩n',
                precio: 1000.00,
                stock: 23,
                estado: 'En Stock'
            }
        ];

        let editingIndex = -1;

        function openModal(mode, index = -1) {
            const modal = document.getElementById('productModal');
            const modalTitle = document.getElementById('modalTitle');
            const form = document.getElementById('productForm');

            if (mode === 'new') {
                modalTitle.textContent = 'Nuevo Producto';
                form.reset();
                editingIndex = -1;
            } else {
                modalTitle.textContent = 'Editar Producto';
                editingIndex = index;
                const product = products[index];
                
                document.getElementById('codigo').value = product.codigo;
                document.getElementById('producto').value = product.producto;
                document.getElementById('categoria').value = product.categoria;
                document.getElementById('precio').value = product.precio;
                document.getElementById('stock').value = product.stock;
                document.getElementById('estado').value = product.estado;
            }

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('productModal').classList.remove('active');
        }

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const newProduct = {
                codigo: document.getElementById('codigo').value,
                producto: document.getElementById('producto').value,
                categoria: document.getElementById('categoria').value,
                precio: parseFloat(document.getElementById('precio').value),
                stock: parseInt(document.getElementById('stock').value),
                estado: document.getElementById('estado').value
            };

            if (editingIndex === -1) {
                products.push(newProduct);
                showNotification('Producto agregado exitosamente', 'success');
            } else {
                products[editingIndex] = newProduct;
                showNotification('Producto actualizado exitosamente', 'success');
            }

            renderTable();
            closeModal();
        });

        function deleteProduct(index) {
            if (confirm('쮼st치s seguro de eliminar este producto?')) {
                products.splice(index, 1);
                renderTable();
                showNotification('Producto eliminado', 'danger');
            }
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            products.forEach((product, index) => {
                const stockClass = product.stock < 10 ? 'stock-low' : 'stock-ok';
                
                tbody.innerHTML += `
                    <tr>
                        <td>${product.codigo}</td>
                        <td>${product.producto}</td>
                        <td>${product.categoria}</td>
                        <td>$${product.precio.toFixed(2)}</td>
                        <td>${product.stock}</td>
                        <td><span class="stock-badge ${stockClass}">${product.estado}</span></td>
                        <td>
                            <button class="action-btn" onclick="openModal('edit', ${index})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteProduct(${index})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            });
            
            // Update reports if visible
            if (document.getElementById('reportesSection').style.display !== 'none') {
                updateReports();
            }
        }

        function updateInventory() {
            showNotification('Inventario actualizado correctamente', 'success');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? '#28a745' : '#dc3545';
            
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Tab switching functionality
        function showTab(tabName) {
            const productosSection = document.getElementById('productosSection');
            const reportesSection = document.getElementById('reportesSection');
            const tabButtons = document.querySelectorAll('.tab-btn');

            // Hide all sections
            productosSection.style.display = 'none';
            reportesSection.style.display = 'none';

            // Remove active class from all buttons
            tabButtons.forEach(btn => btn.classList.remove('active'));

            // Show selected section
            if (tabName === 'productos') {
                productosSection.style.display = 'block';
                tabButtons[0].classList.add('active');
            } else if (tabName === 'reportes') {
                reportesSection.style.display = 'block';
                tabButtons[1].classList.add('active');
                updateReports();
            }
        }

        // Reports functionality
        let categoryChart = null;
        let stockChart = null;

        function updateReports() {
            // Calculate stats
            const totalProducts = products.length;
            const totalValue = products.reduce((sum, p) => sum + (p.precio * p.stock), 0);
            const lowStock = products.filter(p => p.stock < 10).length;
            const categories = [...new Set(products.map(p => p.categoria))].length;

            // Update stat cards
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalValue').textContent = `$${totalValue.toFixed(2)}`;
            document.getElementById('lowStock').textContent = lowStock;
            document.getElementById('categories').textContent = categories;

            // Update charts
            updateCharts();

            // Update summary table
            updateSummaryTable();
        }

        function updateCharts() {
            // Group products by category
            const categoryData = {};
            products.forEach(p => {
                if (!categoryData[p.categoria]) {
                    categoryData[p.categoria] = 0;
                }
                categoryData[p.categoria]++;
            });

            const categoryLabels = Object.keys(categoryData);
            const categoryValues = Object.values(categoryData);

            // Destroy existing charts
            if (categoryChart) categoryChart.destroy();
            if (stockChart) stockChart.destroy();

            // Category Distribution Chart (Doughnut)
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: categoryLabels,
                    datasets: [{
                        data: categoryValues,
                        backgroundColor: [
                            '#dc3545',
                            '#28a745',
                            '#ffc107',
                            '#17a2b8',
                            '#6f42c1',
                            '#fd7e14'
                        ],
                        borderWidth: 2,
                        borderColor: '#1a1a1a'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#fff',
                                padding: 15,
                                font: { size: 12 }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Distribuci칩n por Categor칤a',
                            color: '#fff',
                            font: { size: 16, weight: 'bold' }
                        }
                    }
                }
            });

            // Stock Status Chart (Bar)
            const stockCategories = {
                'En Stock': products.filter(p => p.stock >= 10).length,
                'Stock Bajo': products.filter(p => p.stock < 10 && p.stock > 0).length,
                'Agotado': products.filter(p => p.stock === 0).length
            };

            const stockCtx = document.getElementById('stockChart').getContext('2d');
            stockChart = new Chart(stockCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(stockCategories),
                    datasets: [{
                        label: 'Cantidad de Productos',
                        data: Object.values(stockCategories),
                        backgroundColor: [
                            '#28a745',
                            '#ffc107',
                            '#dc3545'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#dcdcdc',
                                stepSize: 1
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#dcdcdc'
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Estado del Stock',
                            color: '#fff',
                            font: { size: 16, weight: 'bold' }
                        }
                    }
                }
            });
        }

        function updateSummaryTable() {
            const categoryStats = {};

            // Calculate stats per category
            products.forEach(p => {
                if (!categoryStats[p.categoria]) {
                    categoryStats[p.categoria] = {
                        count: 0,
                        totalStock: 0,
                        totalValue: 0,
                        prices: []
                    };
                }
                categoryStats[p.categoria].count++;
                categoryStats[p.categoria].totalStock += p.stock;
                categoryStats[p.categoria].totalValue += p.precio * p.stock;
                categoryStats[p.categoria].prices.push(p.precio);
            });

            // Populate table
            const tbody = document.getElementById('summaryTableBody');
            tbody.innerHTML = '';

            Object.keys(categoryStats).forEach(category => {
                const stats = categoryStats[category];
                const avgPrice = stats.prices.reduce((a, b) => a + b, 0) / stats.prices.length;

                tbody.innerHTML += `
                    <tr>
                        <td>${category}</td>
                        <td>${stats.count}</td>
                        <td>${stats.totalStock}</td>
                        <td>$${stats.totalValue.toFixed(2)}</td>
                        <td>$${avgPrice.toFixed(2)}</td>
                    </tr>
                `;
            });
        }

        function generateReport() {
            alert('Funci칩n de exportar PDF en desarrollo. Los datos se mostrar치n en consola.');
            console.log('=== REPORTE DE INVENTARIO ===');
            console.log('Total Productos:', products.length);
            console.log('Valor Total:', products.reduce((sum, p) => sum + (p.precio * p.stock), 0));
            console.log('Productos:', products);
        }

        // Initialize table on page load
        renderTable();
    </script>

</body>

<!-- Script para men칰s -->
<script>
    function toggleSubmenu(id) {
        document.getElementById(id).classList.toggle("show-submenu");
    }
</script>

</html>
